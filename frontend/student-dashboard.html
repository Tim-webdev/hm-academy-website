<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Student Dashboard - H&M Academy</title>
  <link rel="stylesheet" href="Css/student-dashboard.css" />
</head>
<body>
  <header>
    <h1>üéì Hands and Minds Computer Academy</h1>
    <!-- <nav>
      <a href="student-dashboard.html">Dashboard</a>
      <a href="programs.html">Make Payment</a>
      <a href="logout.html">Logout</a>
    </nav> -->
  </header>

  <main class="dashboard">
    <section class="bio-data-form">
      <h2>üìã Fill Your Bio-Data</h2>
      <form id="biodata-form">
        <input type="text" id="fullName" placeholder="Full Name" required/>
        <input type="tel" id="phone" placeholder="Phone Number" required/>
        <select id="gender" required>
          <option value="">Select Gender</option>
          <option>Male</option>
          <option>Female</option>
          <option>Other</option>
        </select>
        <input type="date" id="dob" required/>
        <textarea id="address" placeholder="Address" rows="3" required></textarea>
        <button type="submit">Submit Bio-Data</button>
      </form>
      <p id="msg"></p>
    </section>
  </main>

<script>
const BASE_URL = window.location.hostname === 'localhost'
    ? 'http://localhost:5000/api'
    : 'https://hm-academy-website.onrender.com/api';

const email = localStorage.getItem('userEmail'); // from login

document.getElementById('biodata-form').addEventListener('submit', async function (e) {
  e.preventDefault();

  const biodata = {
    email,
    fullName: document.getElementById('fullName').value,
    phone: document.getElementById('phone').value,
    gender: document.getElementById('gender').value,
    dob: document.getElementById('dob').value,
    address: document.getElementById('address').value
  };

  try {
    const res = await fetch(`${BASE_URL}/user/save-biodata `, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(biodata)
    });

    const data = await res.json();
    if (data.success) {
      document.getElementById('msg').textContent = '‚úÖ Bio-data submitted successfully!';
      window.location.href = 'student-login.html';
    } else {
      document.getElementById('msg').textContent = '‚ùå ' + data.message;
    }
  } catch (err) {
    document.getElementById('msg').textContent = '‚ùå Server error';
    console.error(err);
  }
});
</script>
</body>
</html>